version: '3'

services:
    ccp-backend:
        image: ccp-backend:latest
        ports:
            - 5121:8080
        depends_on:
            - redis
        networks:
            - ccp-network
        environment:
            - Redis__ConnectionString=redis:6379
        volumes:
            - /var/run/docker.sock:/var/run/docker.sock:rw
        privileged: true

    ccp-frontend:
        image: ccp-frontend:latest
        ports:
            - 5069:80
        depends_on:
            - ccp-backend
        networks:
            - ccp-network

    redis:
        image: redis:latest
        ports:
            - "6379:6379"
        networks:
            - ccp-network

networks:
    ccp-network:
        driver: bridge
