@page "/logs"
@page "/logs/{containerId}"
@page "/logs/{containerId}/{filterDate}"

@using ContainerControlPanel.Domain.Models
@using ContainerControlPanel.Web.Components
@using MudBlazor

<div class="label">
	<h1>@Localizer[Locales.Resource.Logs]</h1>
	@if (!bool.Parse(configuration["Realtime"]) && container != null) 
	{
		<svg @onclick="async () => { await LoadLogs(); }" xmlns="http://www.w3.org/2000/svg" height="24px" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
			<path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z" />
			<path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466" />
		</svg>
	}
	<div class="switch">
		<MudSwitch @bind-Value="enableColors" Label="@Localizer[Locales.Resource.EnableColors]" Color="Color.Success"/>
	</div>	
</div>

<div class="flex">
	<MudSelect T="Container" AnchorOrigin="Origin.BottomCenter" Placeholder="@Localizer[Locales.Resource.ChooseContainer]" TransformOrigin="Origin.TopCenter" @bind-Value="container">
		@foreach (var container in containers)
		{
			<MudSelectItem Value="container">@container.Names</MudSelectItem>
		}
	</MudSelect>
	<MudSelect T="string" AnchorOrigin="Origin.BottomCenter" Placeholder="@Localizer[Locales.Resource.ChooseTimestamp]" TransformOrigin="Origin.TopCenter" @bind-Value="timestamp" Clearable="true">
		<MudSelectItem Value="@("15m")">15 @Localizer[Locales.Resource.Minutes]</MudSelectItem>
		<MudSelectItem Value="@("30m")">30 @Localizer[Locales.Resource.Minutes]</MudSelectItem>
		<MudSelectItem Value="@("60m")">1 @Localizer[Locales.Resource.Hour]</MudSelectItem>
		<MudSelectItem Value="@("360m")">6 @Localizer[Locales.Resource.Hours]</MudSelectItem>
		<MudSelectItem Value="@("720m")">12 @Localizer[Locales.Resource.Hours]</MudSelectItem>
		<MudSelectItem Value="@("1440m")">24 @Localizer[Locales.Resource.Hours1]</MudSelectItem>
		<MudSelectItem Value="@("10080m")">7 @Localizer[Locales.Resource.Days]</MudSelectItem>
	</MudSelect>
	<div class="date-picker">
		<MudDatePicker @bind-Date="filterDate" Clearable="true" DateFormat="dd.MM.yyyy"/>
	</div>
	<div class="time-flex">
		<MudTimePicker Editable="true" @bind-Time="timeFrom"/>
		<MudTimePicker Editable="true" @bind-Time="timeTo"/>
	</div>
</div>


@if (logs.Length > 0) 
{
	<div class="logs-flex">
		<div class="logs-container">	
			@if (enableColors) 
			{
				<ColorfulLogs Logs="@logs"/>
			}
			else 
			{
				@logs
			}		
			<div id="logs-bottom"></div>
		</div>
		<svg @onclick="@(async () => { await scrollHandler.ScrollToElementByIdAsync("logs-bottom"); })" class="scroll-down" xmlns="http://www.w3.org/2000/svg" height="32px" fill="currentColor" viewBox="0 0 16 16">
			<path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4" />
		</svg>
	</div>
}
else if (container != null) 
{
	<div class="not-found">
		@Localizer[Locales.Resource.NoLogsFound].
	</div>
}
else 
{
	<div class="not-found">
		<svg xmlns="http://www.w3.org/2000/svg" width="24px" fill="#00B577" class="bi bi-card-list" viewBox="0 0 16 16">
			<path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z" />
			<path d="M5 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 5 8m0-2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m0 5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m-1-5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0M4 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0m0 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0" />
		</svg>
		@Localizer[Locales.Resource.ChooseResourceTo1].
	</div>
}
